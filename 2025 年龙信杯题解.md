# 2025 年龙信杯题解[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#2025 "Permanent link")

Author

NoahTie @ tratra 什么都会

TODO

当前题解尚不完整, 后续将会持续更新.

目前已更新的题解包括:

- 手机取证部分
- 计算机取证部分

## 比赛信息[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#_1 "Permanent link")

### 案情简介[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#_2 "Permanent link")

本次龙信杯竞赛案情脱胎于 2025 年初的某地知名网络小说知识产权案, 涉案团伙通过非法爬取小说内容, 盗用其付费内容并投放至其自行开发的微信小程序, 通过观看广告非常牟利, 造成原平台巨额经济损失. 龙信受邀参与案件支撑并成功为司法机关提供了关键证据, 助力案件顺利告破.

本次龙信杯案情:

自 2023 年起, "终点小说"公司(以下统称"甲公司")发现, 张大运营的"芯龙小说"软件未获甲公司授权, 利用网络爬虫技术非法抓取、传播甲公司旗下多部热门小说. 涉案作品为甲公司独家授权并付费推广的优质内容, 甲公司依法享有信息网络传播权, 张大的行为已严重侵害甲公司及作者的著作权.

2025 年 10 月 22 日, 甲公司向张大发送律师函, 要求其立即停止侵权、删除全部侵权内容. 张大仅删除部分作品, 随后仍持续抓取、传播其他小说, 侵权行为具有连续性. 面对持续损害甲公司及作者权益和经济损失, 决定向公安机关报案, 揭露并制止这一恶劣的犯罪行为.

### 容器信息[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#_3 "Permanent link")

容器密码: `MjAyNS3oi4/lt57pvpnkv6E=`

容器 MD5: `5b3020c1a3c725febdc8a8bc84f42909`

### 写在前面[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#_4 "Permanent link")

这次比赛的检材整体难度较高并且题量也较大, 比赛时做下来最大的感受是时间不够, 有很多地方来不及细想. 但至少不同的检材之间还是有连续的案情的(除了流量包之外). 检材之间也有少量交互, 但整体还是线性关联: 手机和服务器上都有一些计算机检材需要的信息.

手机取证部分单论自动分析工具(火眼)的分析情况来看, 相当有往年美亚杯的手机的感觉了, 应用几乎都不能自动解析, 需要靠查看应用数据进行手动分析.

计算机取证部分一部分题目有点离谱了, 在完全没有提示的情况下出了一道图片隐写, 不过好在和这部分相关的题目也就只有 1 道. 小说文本对照部分的题目完全可以交给 LLM Agent 自动解题. 整体难度算中等吧.

::TODO::

其余部分还没有完成复盘, 之后再补上.

## 手机取证[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#_5 "Permanent link")

大致浏览一下安装的应用列表, 里面有雷电模拟器预装的应用, 是个从雷电模拟器提取的镜像.

顺便跑一下 APP 包名识别:

![Pasted image 20251109174038.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109174038.png)

|Package Name|App Name|Genre|Source|
|---|---|---|---|
|com.baidu.appsearch|百度手机助手|应用商店|应用宝|
|com.zhulang.reader|逐浪小说|图书阅读|小米应用商店|
|com.bfengtech.diange.diangeapp|电鸽|聊天社交|小米应用商店|
|com.UCMobile|UC浏览器-随心搜·免费看|实用工具|小米应用商店|
|com.ss.android.ugc.aweme|抖音|影音视听|小米应用商店(Cached)|
|com.lemon.lv|剪映|摄影摄像|小米应用商店|
|com.jiandan.terence.sneaker|微秘相册-原私密相册|摄影摄像|小米应用商店|
|com.baidu.newapp|文心-(文小言)|聊天社交|小米应用商店|
|com.yueyou.adreader|阅友免费小说|图书阅读|小米应用商店|
|com.shuqi.controller|书旗小说-海量图书|图书阅读|小米应用商店|
|com.moonshot.kimichat|Kimi-K2长思考上线|实用工具|小米应用商店|
|com.tencent.mm|微信|聊天社交|小米应用商店(Cached)|

需要注意的是其中的 `com.jiandan.terence.sneaker(微秘相册-原私密相册)`.

### 01 请问机身的 Wi-Fi 信号源的物理地址[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#01-wi-fi "Permanent link")

答案

00:db:60:6e:86:13

火眼有分析出来 2 条 WiFi 记录, 一条是雷电模拟器虚拟出来的 WiFi 连接(Cisco-MVlps), 一条是 AP 的信息:

![Pasted image 20251109165429.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109165429.png)

WiFi 是有 MAC 地址的, AP 没有 MAC 地址, 但感觉题目在问的似乎是 AP 的 MAC 地址.

之后的分析已经知道这个镜像是从雷电模拟器的虚拟机提取的, 并且知道安卓系统的版本是安卓 9, 可以创建一个虚拟机验证答案. 以下是我从雷电模拟器的虚拟机提取的镜像中的文件与系统设置的对比:

已连接的虚拟 WiFi 的 MAC 地址与 BSSID 信息一致, 并未使用随机的 MAC 地址:

![Pasted image 20251110201558.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110201558.png)

![Pasted image 20251110201724.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110201724.png)

由于模拟器的设置是简化版的设置, 删除了一些 Activity 的入口, 因此需要通过类似 ActivityManager 的应用来直接启动设置 WLAN 热点的 Activity 才能看到热点密码的设置:

![Pasted image 20251110201610.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110201610.png)

![Pasted image 20251110202557.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110202557.png)

所以应该是题目描述有些模糊, 看题目描述还以为在问 AP 的 MAC 地址. 改成"手机连接的 WiFi 的 MAC 地址"就没有歧义了.

因此可以推断检材中 WiFi 实际的 MAC 地址为 `/misc/wifi/WifiConfigStore.xml` 中的 BSSID `00:db:60:6e:86:13`:

![Pasted image 20251110203600.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110203600.png)

### 02 请问张大的手机号码尾号是 3807 的手机号码[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#02-3807 "Permanent link")

答案

15680193807

在 Kimi 的分析结果中能看到中间隐去 4 位的电话号码 `156****3807`:

![Pasted image 20251109170840.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109170840.png)

用 XWF 加载解压出来的检材文件夹, 在同步搜索中用正则搜索:

![Pasted image 20251110161217.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110161217.png)

在电鸽 APP 的配置文件里面存储有用户的手机号码:

![Pasted image 20251110161310.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110161310.png)

XWF 的正则规则与 Perl 和 grep 一致, 可以参考: [Regular expressions in grep with examples](https://www.cyberciti.biz/faq/grep-regular-expressions/)

### 03 通讯录中号码归属地最多的直辖市[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#03 "Permanent link")

答案

北京市

直辖市一共就几个, 挨个筛选一下, 明显北京的号码是最多的:

![Pasted image 20251109172757.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109172757.png)

### 04 嫌疑人最近卸载过的的一款小说 APP 的名字[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#04-app "Permanent link")

答案

七猫免费小说

在安卓的软件包缓存目录中可以看到软件包的缓存数据:

![Pasted image 20251109174932.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109174932.png)

将其中的第三方包的条目导出为 CSV, 提取包名, 再运行一次 APP 识别, 发现其中有一个 `com.kmxs.reader(七猫免费小说)`

![Pasted image 20251109174839.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109174839.png)

|Package Name|App Name|Genre|Source|
|---|---|---|---|
|com.UCMobile|UC浏览器-随心搜·免费看|实用工具|小米应用商店(Cached)|
|com.baidu.appsearch|百度手机助手|应用商店|应用宝(Cached)|
|com.baidu.newapp|文心-(文小言)|聊天社交|小米应用商店(Cached)|
|com.bfengtech.diange.diangeapp|电鸽|聊天社交|小米应用商店(Cached)|
|com.jiandan.terence.sneaker|微秘相册-原私密相册|摄影摄像|小米应用商店(Cached)|
|com.kmxs.reader|七猫免费小说|图书阅读|小米应用商店|
|com.larus.nova|豆包|实用工具|小米应用商店(Cached)|
|com.lemon.lv|剪映|摄影摄像|小米应用商店(Cached)|
|com.moonshot.kimichat|Kimi-K2长思考上线|实用工具|小米应用商店(Cached)|
|com.shuqi.controller|书旗小说-海量图书|图书阅读|小米应用商店(Cached)|
|com.ss.android.ugc.aweme|抖音|影音视听|小米应用商店(Cached)|
|com.tencent.mm|微信|聊天社交|小米应用商店(Cached)|
|com.tencent.mtt|QQ浏览器-QBot AI智能体|实用工具|小米应用商店(Cached)|
|com.yueyou.adreader|阅友免费小说|图书阅读|小米应用商店(Cached)|
|com.zhulang.reader|逐浪小说|图书阅读|小米应用商店(Cached)|
|sogou.mobile.explorer|搜狗浏览器极速版|实用工具|小米应用商店|

另外还可以看到有 `sogou.mobile.explorer`(搜狗浏览器极速版) `com.larus.nova`(豆包) `com.tencent.mtt`(QQ浏览器-QBot AI智能体)被删除.

### 05 嫌疑人使用"逐浪小说"应用最近一次搜索小说书名[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#05 "Permanent link")

答案

从斗罗开始无敌

**解法 1: 通过应用数据库**

设备上安装有 HttpCanary, 一个安卓平台(现在也有 Windows 平台版本)的抓包工具, 主要捕获 HTTP/HTTPS 协议流量:

![Pasted image 20251110102501.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110102501.png)

在设备的用户自定义证书存储目录中也可以看到安装有 HttpCanary 的根证书:

![Pasted image 20251110103026.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110103026.png)

在 HttpCanary 的数据目录 `/data/com.guoshi.httpcanary/databases` 中的数据库 `app` 中存放着抓包的历史记录, 其中:

- 表 `CAPTURE_SESSION` 存储着用户每次运行抓包捕获到的包的 UUID
- 表 `HTTP_CAPTURE_RECORD` 中保存着抓到的每个包的信息

![Pasted image 20251110104055.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110104055.png)

可以看到, 其中的 `APP` 字段是该流量包是哪个 APP 包名传输的.

在 `APP` 字段中中过滤 `com.zhulang.reader` 包名, 在 `URL` 字段中过滤 `search`:

![Pasted image 20251110110817.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110110817.png)

将数据库中访问的 URL 复制出来, 在 Cyberchef 里面处理(URL 解码, 正则匹配查找关键词):

![Pasted image 20251110110924.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110110924.png)

数据库中越靠后的条目创建时间越晚, 也可以根据 `TIME` 字段的时间戳来判断.

**解法 2: 通过缓存**

这道题也可以通过查看 HttpCanary 存储在 `/media/0/Android/data/com.guoshi.httpcanary/cache` 目录的缓存完成.

在逐浪小说的官网搜索一下, 看看访问的 URI:

![Pasted image 20251109190301.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109190301.png)

去缓存里搜索 `/search/index.html`:

![Pasted image 20251109190329.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109190329.png)

搜索这几个文件:

`http_req_ea384113-d336-438a-a50d-ae3094ebf18e.hcy`

![Pasted image 20251109190845.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109190845.png)

`http_req_1b0f44e9-0bda-43b7-9177-caffc84c56a4.hcy`

![Pasted image 20251109191010.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109191010.png)

`http_req_79656dfd-1c6e-4841-96cd-8fadef089218.hcy`

![Pasted image 20251109191111.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109191111.png)

`http_req_5221af36-35a0-44e8-812b-8451a81f2690.hcy`(最新)

![Pasted image 20251109191149.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109191149.png)

`http_req_1b59c69c-7e4b-472e-ba63-badc5af0e8c3.hcy`

![Pasted image 20251109191300.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109191300.png)

URL 解码:

![Pasted image 20251109191351.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251109191351.png)

### 06 嫌疑人曾使用"QQ 浏览器"使用过的搜索关键词有几个[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#06-qq "Permanent link")

答案

27

参考第 4 题的分析, 设备上曾经安装过 QQ 浏览器, 但是已经被删除. 因此数据目录也应该被清除了.

在该字段中过滤 QQ 浏览器的包名 `com.tencent.mtt`:

可以看到用户使用的搜索引擎是搜狗 `m.sogou.com`, 可以访问一下移动端的搜狗看一下搜索的 URI 和关键词的 GET 参数名是什么, 发现访问的路由是 `/web/SearchList.jsp`, GET 请求的参数是 `keyword`. 据此, 在数据库中过滤:

![Pasted image 20251110105022.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110105022.png)

把数据库里访问的 URL 复制出来, 在 Cyberchef 里面处理(URL 解码, 正则匹配查找关键词, 去重):

![Pasted image 20251110162949.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110162949.png)

一共搜索过 27 个不同的关键词.

这道题也可以通过查看 HttpCanary 存储在 `/media/0/Android/data/com.guoshi.httpcanary/cache` 目录的缓存完成, 但这样的话缺失了 HTTP 流量来源应用的信息, 不是很严谨.

### 07 嫌疑人曾经安装过的一款 AI 软件登录的用户名[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#07-ai "Permanent link")

答案

用户885861

题目中专门表明"曾安装", 也就是现在已经删除的应用. 参考第 4 题的分析, 设备上还有 `com.larus.nova`(豆包)被删除, 符合题目的描述.

在 HttpCanary 的数据库中过滤 `APP` 字段, 发现有豆包 APP 的流量:

![Pasted image 20251110111228.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110111228.png)

浏览几条流量, 发现请求的参数中都包含 `user_is_login`, 值为 0 或 1, 推测是标识用户是否登录. 在 `URL` 字段中过滤 `user_is_login=1`, 找到登录后发送的第一个请求, `SESSION_ID` 为 `89fb4e70-fdd6-424f-8cdd-b965f576a7b8`:

![Pasted image 20251110111929.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110111929.png)

这里可以看到 UID 是 `1197846826330169`, 但是看不到用户名. 需要去 HttpCanary 的缓存目录中寻找完整的响应包. 在目录中搜索获得的 UID. 由于 URL 中也包含 UID, 观察响应体的 JSON 可以发现, 服务端返回的 UID 是字符串的形式, 因此可以在搜索时为 UID 的前后加上英文的引号, 排除仅 URL 包含 UID 的文件:

![Pasted image 20251110113206.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110113206.png)

### 08 接上问, 嫌疑人在此 AI 软件中最后一次提问的内容[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#08-ai "Permanent link")

答案

小说爬取会侵权嘛

接上题. 翻看一些包含 UID 的响应包, 发现了对用户问题的回答:

![Pasted image 20251110113817.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110113817.png)

根据文件名在数据库中找到对应的请求, 找到请求的 URL 为 `https://api-normal.doubao.com/im/chain/single`:

![Pasted image 20251110113924.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110113924.png)

在数据库中过滤该 URL, 找到最后一条请求:

![Pasted image 20251110114029.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110114029.png)

在缓存中搜索文件名与该请求的 `SESSION_ID` 一致的文件:

![Pasted image 20251110114148.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110114148.png)

一个是请求, 一个是响应, 查看响应. 然而这个包是空的, 只有豆包的推荐内容.

再往前看一条:

![Pasted image 20251110114502.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110114502.png)

Cyberchef 格式化一下 JSON:

![Pasted image 20251110115113.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110115113.png)

可以看到用户提问的内容是"小说爬取会侵权嘛", 而且是通过语音提问的(问题内容出现在 `tts_content` 中).

### 09 嫌疑人花费多少元购买小说网站源码[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#09 "Permanent link")

答案

1300

参考第 4 题, 设备中安装有即时通讯软件 `com.bfengtech.diange.diangeapp`(电鸽), 可惜火眼目前还没有该应用的解析插件, 只能手动分析了.

在数据目录可以看到包含"flutter"字样的文件夹, 推断该应用使用了 Flutter 框架. 在 Flutter 应用中, Flutter 框架内部的数据保存在 `app_flutter` 目录中. 在该目录中存放着 APP 的数据库 `OpenIM_v3_uid_1757820856679172.db`.

数据库中一共有 2 个包含消息记录的表. 其中一张表中可以看到关于购买网站源码的记录:

![Pasted image 20251110131339.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110131339.png)

### 10 接上问, 嫌疑人购买的小说网站源码的 MD5 值[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#10-md5 "Permanent link")

答案

5a312a2cd50493f908a4f905f2d9ed2d

接上题, 这里发送了 4 个非文本的消息, 第 1 条是软件内置的表情包, 后 3 条均为文件:

![Pasted image 20251110131750.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110131750.png)

可以在应用的数据目录 `/media/0/Android/data/com.bfengtech.diange.diangeapp/files/diange/files/` 中找到这些文件:

![Pasted image 20251110131835.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110131835.png)

然而这些文件还有另外一种获取方式. 由于电鸽的 API 并没有对访问做任何鉴权, 只要拿到文件的 URL, 任何人都可以直接下载这些文件:

![Pasted image 20251110132241.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110132241.png)

并且 URL 中没有任何混淆或哈希处理, 格式为 `https://v3.api.production.diangeapp.com/api/object/uid_<上传文件的用户的 UID>/<文件名>`, 存在路径枚举及未授权访问的漏洞. 真好, 打取证比赛顺便还报了个漏洞.

算一下文件的哈希:

![Pasted image 20251110135433.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110135433.png)

### 11 嫌疑人的虚拟钱包地址[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#11 "Permanent link")

答案

0x2a80985eea4283fdebddc5ec25c15d8cb5bcc09f

在另外 1 个聊天记录表里:

![Pasted image 20251110131153.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110131153.png)

可以拿到卖家的钱包地址为 `0x099097e9497de4de96effccd9f5ccb76822095d2`.

使用的虚拟货币是 USDT, 去 [TokenView](https://usdt.tokenview.io/en/address/0x099097e9497de4de96effccd9f5ccb76822095d2) 查一下这个地址:

可以看到疑似与嫌疑人的钱包地址转账的记录(复盘时是比赛后的第 2 天, 2025-11-10 14:00 左右):

![Pasted image 20251110135959.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110135959.png)

查看转入的那条交易的信息:

![Pasted image 20251110140056.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110140056.png)

嫌疑人表示钱已转过去时是 `2025-10-23 09:50:22`, 转账发生在 `2025-10-23 09:47:23`, 交易记录与聊天记录的时间先后顺序也能对上:

![Pasted image 20251110140208.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110140208.png)

紧挨着的转出交易, 卖家又将收到的虚拟货币通过 Coinhako(一个新加坡的虚拟货币交易平台)卖出, 时间是 `2025-10-23 09:57:11`:

![Pasted image 20251110140532.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110140532.png)

### 12 嫌疑人购买视频网站源码花费了多少 USDT[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#12-usdt "Permanent link")

答案

1000

参考上题.

### 13 其接受过一个远控木马程序, 请问其 MD5 值[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#13-md5 "Permanent link")

答案

f3399f9b9ede9601edb648a2abe4a090

参考第 10 题. 远控木马明显是在 `yuankong（123456，不要在本机运行）.zip` 中, 解压得到 1 个 PE 文件(拿到疑似恶意程序的第一件事: 修改扩展名, 以防误运行):

![Pasted image 20251110141107.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110141107.png)

奇怪的是火绒这次居然没有报毒, 根据后续的分析判断, 这个程序其实不具有恶意功能, 只是模仿了一些远控的行为.

![Pasted image 20251110141311.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110141311.png)

### 14 接上题, 该 exe 使用了哪种压缩方式[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#14-exe "Permanent link")

答案

UPX

PE 的压缩方式第一反应就是 UPX. 用 DIE 查看信息:

这里可以看到一些不太正常的结果:

![Pasted image 20251110141455.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110141455.png)

首先, DIE 识别出来了 UPX 的特征, 但是没能确定具体的版本, 只能根据特征判断是 `UPX >= 3.91`.

其次, Heur 识别出来了 PE 文件被打包, `EntryPoint`(Load 指令)和导入表很像 UPX, 但 UPX 的节是损坏了的, 变成了 `VMP`, 并且在 `rsrc` 节中是被压缩的数据.

到这里, 很像前两年西电的 MoeCTF 里出过的一道题, 也是对 UPX 压缩的 PE 进行了修改, 但是那道题是修改了 Load 指令的部分, 导致 DIE 查出来类似的报错.

010 Editor 打开, 跑一下 PE 文件的模板:

![Pasted image 20251110142331.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110142331.png)

Section Header 明显是被改过了, 把 `UPX` 改成了 `VMP`, 顺便还能看到 UPX 的具体版本是 4.10.

### 15 接上题, 该 exe 使用的压缩方式修改了几处特征[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#15-exe "Permanent link")

答案

3

见上题.

### 16 接上题, 该 exe 外联的端口号[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#16-exe "Permanent link")

答案

4444

接上题.

把 `VMP` 改回 `UPX`. 改完之后再跑一次模板, 一切正常:

![Pasted image 20251110142547.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110142547.png)

用 UPX4.10 去壳:

![Pasted image 20251110143524.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110143524.png)

如果这里因为之前在 DIE 中看到了 Pyinstaller 的特征直接去用 Pyinstxtractor 解包的话, 可以直接解出来 `rsrc` 里的另外 1 个 PE 文件, 也就是之后提到的被释放出来的 exe, 这个释放出来的文件才是 Pyinstaller 打包的. 而原本的 PE 文件并非 Pyinstaller 打包的.

使用 IDA 加载去壳后的文件, 找到 `main` 函数. 可以看到应用创建了一个新的线程:

![Pasted image 20251110144308.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110144308.png)

跟进新线程的函数 `post_pgo_initialization`, 里面也是调用了一个函数, 继续跟进 `sub_1400019B0`:

![Pasted image 20251110144511.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110144511.png)

开了个 Socket 连接, ip 地址是 `192.168.93.129`, 端口是 `4444`. 之后看起来会远程接受 Socket 传入的数据, 作为命令通过 cmd 执行:

![Pasted image 20251110144825.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110144825.png)

但是感觉代码写的不太对劲, 执行命令的代码全放在 while 循环的外面了, 也就是只有 Socket 连接断前最后一次传输的指令才会被运行. 而且 `main` 里面刚创建完 Socket 通信的线程就给 CloseHandle 了...

### 17 接上题, 该 exe 会搜索并加密几种类型的文件[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#17-exe "Permanent link")

答案

3

在字符串视图里可以看到相关的文件扩展名:

![Pasted image 20251110145329.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110145329.png)

找到调用字符串的函数:

![Pasted image 20251110145418.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110145418.png)

呃...创建了个 `C:\\test\\EncryptedDocs` 目录, 然后在函数参数 `a1` 传入的目录里递归遍历文件, 如果文件名的符合 `*.doc` `*.xlsx` `*.docx` 格式, 则用 `sub_140001230` 函数处理文件. 而 `sub_140001230` 的功能是, 将文件的原本内容复制到参数 `a1` 目录中, 添加 `.enc` 扩展名. 我算是知道为啥火绒没报毒了.

### 18 接上题, 该 exe 会释放一个新的 exe, 请问新的 exe 是用哪种编程语言编写的[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#18-exe-exe-exe "Permanent link")

答案

Python

主函数中的 `sub_1400017B0` 函数用于加载资源并将 `EXE` 资源写入到 `%TEMPDIR%/mail.exe` 目录中. 接着运行该程序.

可以使用 010 Editor 直接导出该应用:

![Pasted image 20251110151024.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110151024.png)

用 DIE 查看信息:

![Pasted image 20251110151111.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110151111.png)

### 19 接上题, 释放出的 exe 使用的邮件服务器的授权码[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#19-exe "Permanent link")

答案

qycirqwzxogjdgbh

接上题. 使用 Pyinstxtractor 解包:

![Pasted image 20251110151234.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110151234.png)

根据解包过程中的信息, 程序的入口点应该是 `test.pyc`.

用 Pylingual 反编译 `test.pyc`, 得到源码:

`import itertools import hashlib import string import sys from math import gcd from Crypto.Util.number import * import gmpy2 import smtplib from email.mime.text import MIMEText from email.mime.multipart import MIMEMultipart from email.mime.application import MIMEApplication from email.header import Header import os  def send_email(sender, password, receiver, subject, body, attachment_path=None, smtp_server='smtp.qq.com', smtp_port=465):     """     发送带附件的邮件     :param sender: 发件人邮箱     :param password: 发件人邮箱授权码（不是登录密码）     :param receiver: 收件人邮箱（字符串或列表）     :param subject: 邮件主题     :param body: 邮件正文     :param attachment_path: 附件文件路径（可选）     :param smtp_server: SMTP 服务器地址     :param smtp_port: SMTP 端口（默认 465 SSL）     """     message = MIMEMultipart()     message['From'] = Header(sender)     message['To'] = Header(receiver if isinstance(receiver, str) else ', '.join(receiver))     message['Subject'] = Header(subject, 'utf-8')     message.attach(MIMEText(body, 'plain', 'utf-8'))     if attachment_path and os.path.exists(attachment_path):         with open(attachment_path, 'rb') as f:             part = MIMEApplication(f.read())             part.add_header('Content-Disposition', 'attachment', filename=os.path.basename(attachment_path))             message.attach(part)     elif attachment_path:         print(f'⚠️ 附件路径不存在：{attachment_path}')     try:         with smtplib.SMTP_SSL(smtp_server, smtp_port) as smtp:             smtp.login(sender, password)             smtp.sendmail(sender, receiver if isinstance(receiver, list) else [receiver], message.as_string())             print('✅ 邮件发送成功！')     except Exception as e:         return None if __name__ == '__main__':     sender_email = '2934235261@qq.com'     sender_auth_code = 'qycirqwzxogjdgbh'     receiver_email = sys.argv[1]     attachment_path = sys.argv[2]     send_email(sender=sender_email, password=sender_auth_code, receiver=receiver_email, subject='Python 自动发送邮件测试', body='你好，这是一封 Python 自动发送的测试邮件。\n附件请查收。', attachment_path=attachment_path, smtp_server='smtp.qq.com', smtp_port=465)`

很明显功能就是发送邮件.

### 20 嫌疑人发布的抖音作品是参考哪篇文学巨著生成的[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#20 "Permanent link")

答案

钢铁是怎样炼成的

在抖音的分析结果中可以看到几条发布的作品, 查看之后发现内容是小说:

![Pasted image 20251110152227.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110152227.png)

在 Kimi 的分析结果中, 可以看到用户用 Kimi 生成的小说原文, 是参考《钢铁是怎样炼成的》生成的:

![Pasted image 20251110152509.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110152509.png)

### 21 嫌疑人通过抖音发布了几个作品[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#21 "Permanent link")

答案

5

见上题.

### 22 接上题, 作品 ID 为 7564293625007115554 的观众浏览量为[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#22-id-7564293625007115554 "Permanent link")

答案

23

用作品 ID 在抖音的数据目录中爆搜:

![Pasted image 20251110170657.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110170657.png)

找到的文件里面是 JSON 格式的数据, 用 VSCode 打开, 再次搜索, 翻了一会儿找到了:

![Pasted image 20251110170623.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110170623.png)

### 23 嫌疑人相册中的图片为其非法所得, 是多少(不考虑重复)[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#23 "Permanent link")

本题暂无答案

本题暂无答案

一堆图片...找找有没有比较好的统计方法.

### 24 嫌疑人电脑的开机密码[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#24 "Permanent link")

答案

qwe321@@@

设备中还有 1 个没有识别出来的应用, 看包名是个备忘录 APP:

![Pasted image 20251110171234.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110171234.png)

在应用的数据目录中可以看到电脑密码和 BitLocker 密码:

![Pasted image 20251110171348.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251110171348.png)

## 计算机取证(Windows)[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#windows "Permanent link")

### 01 PowerShell 中多少个命令包含 URL 地址[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#01-powershell-url "Permanent link")

答案

5

火眼的终端历史记录分析结果中, 搜索"http":

![Pasted image 20251111150834.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111150834.png)

### 02 VeraCrypt 加密容器密码[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#02-veracrypt "Permanent link")

答案

UJw4FspAsmNVRACWf4GQazvd

容器很好找, 不管是查找检材中的大文件, 用火眼的特征分析, 还是跟我一样习惯性地先浏览用户文件夹, 都可以找到加密容器:

![Pasted image 20251111151413.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111151413.png)

容器的密码在剪贴板的固定项中, 需要仿真后按下 `Win + V` 才能看到:

![Pasted image 20251111152327.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111152327.png)

Windows 剪切板的数据不会保存, 在关机后会清空. 但剪切板中的固定项会被保存下来. 数据的保存目录是 `C:/Users/Administrator/AppData/Local/Microsoft/Windows/Clipboard/Pinned/`, 但是数据被加密:

![Pasted image 20251111153014.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111153014.png)

我查到的资料说这部分文件加密使用的算法是 Windows CryptoAPI 里的 CNG 算法, 使用的参数包括用户的 SID, 用户密码, MasterKeyFile(存储在 `/Users/Administrator/AppData/Roaming/Microsoft/Crypto/Keys` 目录)但是目前还没有成功解密.

### 03 加密容器中"密码本.txt"文件的 SHA-256 哈缩希值[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#03-txt-sha-256 "Permanent link")

答案

4fc75a56a7c3e08b3f6d1c018d366a9139422b4c3c09f367dd64aca2b18e3fc7

挂载 VeraCrypt 容器之后, 用 FTK Imager 或火眼加载容器卷, 在回收站中可以看到密码本文件:

![Pasted image 20251111162130.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111162130.png)

导出之后计算哈希值:

![Pasted image 20251111162319.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111162319.png)

### 04 接上题, 分析其账单数据中哪个类别的金额最多[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#04 "Permanent link")

答案

小说网站

用密码本中的口令爆破 VC 容器中的"账单数据.zip".

zip2john 导出哈希:

![Pasted image 20251111162628.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111162628.png)

编辑导出的哈希, 去掉首尾的文件名和冒号. HashCat 爆破:

![Pasted image 20251111163034.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111163034.png)

得到解压密码是 `VteGElLDQu`. 或者也可以用 Passware, 添加一下字典就行.

解压之后里面有 30 个 Excel 表格文件, 比较多, 内容大概是:

![Pasted image 20251111163325.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111163325.png)

这里提供 2 种统计的方法.

**第一种**

本地起一个 mysqld, Navicat 连接, 使用导入功能从 Excel 导入数据. 建议可以先导入 1 个表格, 自动创建好表结构. 之后再将其余表格数据导入到这张创建好的表中.

查一下每类的金额总和:

![Pasted image 20251111164340.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111164340.png)

**第二种**

用弘连的网矩数据分析工具.

讲整个解压出来的文件夹导入, 文件预处理完成后选择合并文件, 使用图表功能生成柱状图:

![Pasted image 20251111164822.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111164822.png)

![Pasted image 20251111164856.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111164856.png)

### 05 Bitlocker 的恢复密钥[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#05-bitlocker "Permanent link")

答案

541079-719906-009438-610390-527406-567622-466598-347765

这道题是真的想不到...

和 VC 容器放在一起的还有几个图片文件, 其中的 `3.png` 的文件头是 webp 的文件头, 但是 magika 能识别到 PNG 的特征, binwalk 跑了一下里面塞了张 PNG 图片:

![Pasted image 20251111171459.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111171459.png)

打开的时候 IrfanView 报错了, 但是其他查看器又能打开, 应该是 CRC 校验没过:

![Pasted image 20251111171531.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111171531.png)

![Pasted image 20251111171624.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111171624.png)

跑一下 PNG 宽高检查, 发现真实的高度应该是 442 像素:

![Pasted image 20251111171638.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111171638.png)

修改高度:

![Pasted image 20251111171750.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111171750.png)

里面隐写了个 BitLocker 的恢复密钥:

![Pasted image 20251111171840.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111171840.png)

### 06 嫌疑人使用的 Windows 激活工具的版本[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#06-windows "Permanent link")

答案

4.2.8

用手机部分找到的密码或上道题找到的恢复密钥都可以解密计算机的 D 盘的 BitLocker. 在 `/Program Files/AAct/` 目录下是一个激活工具. 目录中包含一张截图, 可以看到版本号是 `4.2.8`:

![Pasted image 20251111173909.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111173909.png)

在 `AAct.exe` 的属性中也可以看到:

![Pasted image 20251111174209.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111174209.png)

### 07 嫌疑人电脑中安装有除 VeraCrypt 之外的加密软件, 其版本是多少[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#07-veracrypt "Permanent link")

答案

1.17.1

在 `C:/Program Files/Cryptomator/Cryptomator.exe` 安装了 1 个加密工具(看应用名称大概就能猜出来):

![Pasted image 20251111174642.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111174642.png)

在仿真系统中运行, 查看关于信息:

![Pasted image 20251111174816.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111174816.png)

在 `C:/Program Files/Cryptomator/app/Cryptomator.cfg` 文件中也可以看到应用的具体版本:

![Pasted image 20251111175049.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111175049.png)

### 08 接上题, 该加密软件恢复秘钥文件最后一个单词[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#08 "Permanent link")

答案

accent

WPS 文件访问记录中有一个"恢复密钥.docx":

![Pasted image 20251111165138.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111165138.png)

其中有一堆单词, 最后几个单词被设置成白色, 又是隐写:

![Pasted image 20251111180823.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111180823.png)

在仿真系统中运行 Cryptomator, 使用恢复密钥重置保险保险库的密码:

![Pasted image 20251111181016.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111181016.png)

之后用重置后的密码解锁并挂载保险库:

![Pasted image 20251111181133.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111181133.png)

### 09 mysql 数据库的存储路径[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#09-mysql "Permanent link")

答案

`D:/phpstudy_pro/Extensions/MySQL5.7.26/data/`

火眼的 MYSQL 解析分析结果里面可以看到数据库的存储路径:

![Pasted image 20251111181432.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111181432.png)

### 10 对比数据库与爬取小说数据, 数据库中缺少的小说其共有多少章节[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#10 "Permanent link")

答案

3

直接使用火眼的数据库解析工具解析 MySQL 数据库, 可以看到数据库内 `chapters` 表内共 958 行数据:

![Pasted image 20251111191646.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111191646.png)

爬取的小说数据内有 961 个文件, 每个文件都是 1 个章节:

![Pasted image 20251111191619.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111191619.png)

### 11 嫌疑人爬取的小说共有多少汉字(包括繁体汉字, 不计标点符号)[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#11_1 "Permanent link")

答案

2946354

这道题及之后的几道题目使用 Cline + GLM-4.6 完成.

System Prompt:

`你将为用户提供 Python 代码编写和数据分析的支持. 在编写代码时, 需要注意:  - 不要生成注释 - 不要生成不必要的输出 - 严格遵守用户的功能需求 - 如果用户对概念的定义与实际定义有区别, 遵守用户给出的定义 - 编写的代码尽量遵守 Python 代码规范, 并且 Pythonic`

Prompt:

`统计当前文件夹及其子目录内所有txt文件中说共有多少汉字（包括繁体汉字，不计标点符号）`

生成的代码:

`import os import re from pathlib import Path  def is_chinese_char(char):     code_point = ord(char)      if 0x4e00 <= code_point <= 0x9fff:         return True     if 0x3400 <= code_point <= 0x4dbf:         return True     if 0x20000 <= code_point <= 0x2a6df:         return True     if 0x2a700 <= code_point <= 0x2b73f:         return True     if 0x2b740 <= code_point <= 0x2b81f:         return True     if 0x2b820 <= code_point <= 0x2ceaf:         return True     if 0xf900 <= code_point <= 0xfaff:         return True     return False  def count_chinese_in_text(text):     count = 0     for char in text:         if is_chinese_char(char):             count += 1     return count  def count_chinese_in_file(file_path):     try:         with open(file_path, 'r', encoding='utf-8') as f:             content = f.read()             return count_chinese_in_text(content)     except UnicodeDecodeError:         try:             # 尝试其他编码             with open(file_path, 'r', encoding='gbk') as f:                 content = f.read()                 return count_chinese_in_text(content)         except Exception as e:             print(f"无法读取文件 {file_path}: {e}")             return 0     except Exception as e:         print(f"读取文件 {file_path} 时出错: {e}")         return 0  def scan_directory(directory):     txt_files = []     directory_path = Path(directory)      for file_path in directory_path.rglob("*.txt"):         txt_files.append(file_path)      return txt_files  def main():     current_dir = "."     txt_files = scan_directory(current_dir)        total_chars = 0     file_stats = []      for file_path in txt_files:         char_count = count_chinese_in_file(file_path)         total_chars += char_count         file_stats.append((file_path, char_count))      print(f"总计: {total_chars:,} 个汉字")     print(f"涉及文件数: {len(txt_files)} 个")      dir_stats = {}     for file_path, char_count in file_stats:         dir_name = file_path.parent.name         if dir_name not in dir_stats:             dir_stats[dir_name] = 0         dir_stats[dir_name] += char_count      for dir_name, char_count in sorted(dir_stats.items()):         print(f"{dir_name}/: {char_count:,} 个汉字")  if __name__ == "__main__":     main()`

运行结果:

![Pasted image 20251111192354.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111192354.png)

在无法使用 LLM 的情况下可以在终端中运行:

`cat ./*/*.txt > all.txt`

将所有目录中的 txt 文件的内容整合到 1 个 txt 文件中. 使用任意编辑器打开这个 txt 文件, 通过替换功能将所有的中文全角标点(`。` `，` `“` `”` `·` `‘` `’` `？` `！` `：` `；` `（` `）` `《` `》` `—`)删除.

再用 Word 等文字编辑工具查看文件的中文字符数统计:

![Pasted image 20251111193932.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111193932.png)

### 12 嫌疑人为躲避侵权, 将爬取文本中多个不同汉字分别替换成另一些汉字(如"我" -> "窝"), 分析共有多少个不同汉字被替换(相同字仅计一次)[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#12- "Permanent link")

答案

5

Prompt:

`对比 @/爬取-原本 和 @/爬取-替换 中对应txt文件中共有多少个不同汉字被替换（相同字仅计一次）`

生成的代码:

`import os from pathlib import Path  def is_chinese_char(char):     code_point = ord(char)     if 0x4e00 <= code_point <= 0x9fff:         return True     if 0x3400 <= code_point <= 0x4dbf:         return True     return False  def count_unique_replacements():     original_dir = "爬取-原本"     replaced_dir = "爬取-替换"      all_replacements = set()     files_with_replacements = 0      for original_file in Path(original_dir).rglob("*.txt"):         relative_path = original_file.relative_to(Path(original_dir))         replaced_file = Path(replaced_dir) / relative_path          if not replaced_file.exists():             continue          try:             with open(original_file, 'r', encoding='utf-8') as f:                 original_content = f.read()             with open(replaced_file, 'r', encoding='utf-8') as f:                 replaced_content = f.read()         except:             continue          replacements = set()         min_length = min(len(original_content), len(replaced_content))          for i in range(min_length):             orig_char = original_content[i]             repl_char = replaced_content[i]              if orig_char != repl_char and is_chinese_char(orig_char) and is_chinese_char(repl_char):                 replacements.add((orig_char, repl_char))          if replacements:             files_with_replacements += 1             all_replacements.update(replacements)      unique_original_chars = set(orig for orig, repl in all_replacements)      return len(unique_original_chars), len(all_replacements), files_with_replacements, all_replacements  def main():     unique_chars_count, total_replacements, files_count, all_replacements = count_unique_replacements()      print(f"被替换的不同汉字数量: {unique_chars_count}")     print(f"总替换组数: {total_replacements}")      print("\n具体替换关系:")     replacement_dict = {}     for orig, repl in all_replacements:         if orig not in replacement_dict:             replacement_dict[orig] = []         replacement_dict[orig].append(repl)      for orig_char in sorted(replacement_dict.keys()):         repl_chars = replacement_dict[orig_char]         if len(repl_chars) == 1:             print(f"  {orig_char} → {repl_chars[0]}")         else:             print(f"  {orig_char} → {', '.join(repl_chars)}")  if __name__ == "__main__":     main()`

运行结果:

![Pasted image 20251111192704.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111192704.png)

在无法使用 LLM 的情况下, 这道题也可以用 UltraCompare 等工具对目录进行比对, 并将比对结果输出为 JSON 格式文件, 再用 Python 进行进一步分析.

### 13 对比爬取数据与替换数据, 被替换汉字(不去重)数量最多的文件名称是什么？[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#13 "Permanent link")

答案

第0062章.txt

Prompt:

`对比爬取数据与替换数据，被替换汉字（不去重）数量最多的文件名称是什么？`

生成的代码:

`import os from pathlib import Path  def is_chinese_char(char):     code_point = ord(char)     if 0x4e00 <= code_point <= 0x9fff:         return True     if 0x3400 <= code_point <= 0x4dbf:         return True     return False  def count_replacements_in_file(original_file, replaced_file):     try:         with open(original_file, 'r', encoding='utf-8') as f:             original_content = f.read()         with open(replaced_file, 'r', encoding='utf-8') as f:             replaced_content = f.read()     except:         return 0, {}      replacement_count = 0     replacement_details = {}      min_length = min(len(original_content), len(replaced_content))      for i in range(min_length):         orig_char = original_content[i]         repl_char = replaced_content[i]          if orig_char != repl_char and is_chinese_char(orig_char) and is_chinese_char(repl_char):             replacement_count += 1             key = f"{orig_char}→{repl_char}"             replacement_details[key] = replacement_details.get(key, 0) + 1      return replacement_count, replacement_details  def find_most_replaced_file():     original_dir = "爬取-原本"     replaced_dir = "爬取-替换"      max_count = 0     max_file = ""     max_details = {}     file_stats = []      for original_file in Path(original_dir).rglob("*.txt"):         relative_path = original_file.relative_to(Path(original_dir))         replaced_file = Path(replaced_dir) / relative_path          if not replaced_file.exists():             continue          count, details = count_replacements_in_file(original_file, replaced_file)          if count > 0:             file_stats.append((str(relative_path), count, details))              if count > max_count:                 max_count = count                 max_file = str(relative_path)                 max_details = details      return max_file, max_count, max_details, file_stats  def main():     max_file, max_count, max_details, file_stats = find_most_replaced_file()      if max_file:         print(f"被替换汉字数量最多的文件: {max_file}")         print(f"替换总数: {max_count}")  if __name__ == "__main__":     main()`

运行结果:

![Pasted image 20251111194330.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111194330.png)

### 14 对比爬取数据与替换数据, 是否存在完全没有汉字被替换的文件? 若存在, 请给出文件的数量[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#14 "Permanent link")

答案

26

Prompt:

`对比爬取数据与替换数据，是否存在完全没有汉字被替换的文件？若存在，请给出文件的数量；若不存在，请直接输出“否”`

生成的代码:

`import os from pathlib import Path  def is_chinese_char(char):     code_point = ord(char)     if 0x4e00 <= code_point <= 0x9fff:         return True     if 0x3400 <= code_point <= 0x4dbf:         return True     return False  def has_replacements(original_file, replaced_file):     try:         with open(original_file, 'r', encoding='utf-8') as f:             original_content = f.read()         with open(replaced_file, 'r', encoding='utf-8') as f:             replaced_content = f.read()     except:         return False      min_length = min(len(original_content), len(replaced_content))      for i in range(min_length):         orig_char = original_content[i]         repl_char = replaced_content[i]          if orig_char != repl_char and is_chinese_char(orig_char) and is_chinese_char(repl_char):             return True      return False  def count_no_replacement_files():     original_dir = "爬取-原本"     replaced_dir = "爬取-替换"      total_files = 0     files_with_replacements = 0     files_without_replacements = 0     no_replacement_files = []      for original_file in Path(original_dir).rglob("*.txt"):         relative_path = original_file.relative_to(Path(original_dir))         replaced_file = Path(replaced_dir) / relative_path          total_files += 1          if not replaced_file.exists():             continue          if has_replacements(original_file, replaced_file):             files_with_replacements += 1         else:             files_without_replacements += 1             no_replacement_files.append(str(relative_path))      return total_files, files_with_replacements, files_without_replacements, no_replacement_files  def main():     total_files, files_with_replacements, files_without_replacements, no_replacement_files = count_no_replacement_files()      print(f"总文件数: {total_files}")     print(f"有替换的文件数: {files_with_replacements}")     print(f"无替换的文件数: {files_without_replacements}")  if __name__ == "__main__":     main()`

运行结果:

![Pasted image 20251111201213.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111201213.png)

### 15 嫌疑人使用的默认浏览器名称[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#15 "Permanent link")

答案

Ablaze Floorp

在仿真系统的系统设置中可以看到 HTTP 和 HTTPS 协议的默认应用是 Floorp:

![Pasted image 20251111201518.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111201518.png)

运行 Floorp 浏览器之后, 在关于中可以看到:

![Pasted image 20251111201636.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111201636.png)

所以 Floorp 浏览器的正式全称应该是"Ablaze Floorp", 但关于界面又显示了"Floorp Browser", 不知道官方给这道题的正确答案是哪个.

### 16 嫌疑人使用的 AI 网站的端口[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#16-ai "Permanent link")

答案

18480

用户桌面上有 1 张截图, 内容是部署在内网的 Open WebUI 的界面:

![Pasted image 20251111201944.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111201944.png)

或者在 Floorp 的历史记录中也能看到 Open WebUI 的 URL:

![Pasted image 20251111202104.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111202104.png)

### 17 嫌疑人使用的 AI 网站登录密码[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#17-ai "Permanent link")

答案

g123123

在 Floorp 保存的密码中可以看到:

![Pasted image 20251111202144.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111202144.png)

### 18 嫌疑人利用在线 AI 模仿创作的小说, 其第五章标题[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#18-ai "Permanent link")

答案

长安的回响

在 Administrator 用户的文档目录中可以看到从智谱清言下载的 LLM 对话记录:

![Pasted image 20251111202734.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111202734.png)

第五章的标题:

![Pasted image 20251111202809.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111202809.png)

### 19 终点小说初步要求嫌疑人赔偿的经济损失金额为多少万元人民币[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#19 "Permanent link")

答案

10

火眼的 Eml 邮件分析结果中有 1 条 eml 文件:

![Pasted image 20251111202842.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111202842.png)

内容是律师事务所发送的邮件:

![Pasted image 20251111211536.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111211536.png)

### 20 根据律师函要求, 嫌疑人最晚须于几月几日(含当日)前向终点小说提交经审核同意的书面致歉函[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#20_1 "Permanent link")

答案

10月28日

见上题.

### 21 嫌疑人NAS映射的盘符[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#21-nas "Permanent link")

答案

Z

仿真系统里在"此电脑"里可以看到.

![Pasted image 20251111212342.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111212342.png)

火眼的网络位置分析结果中也能看到:

![Pasted image 20251111212451.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111212451.png)

### 22 嫌疑人当时正在阅读的小说叫什么名字[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#22 "Permanent link")

答案

小年小月

软件在 NAS 上, 但是不影响做题.

直接去网上下一个 NeatReader 就行, 或者用 `C:\Users\Administrator\AppData\Local\neatreader-updater` 里的安装包. 因为软件的数据保存在本地的 `C:/Users/Administrator/AppData/Roaming/NeatReader/bookData` 目录, 只要装个软件就能绕过 NAS 做这道题.

![Pasted image 20251111212210.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111212210.png)

![Pasted image 20251111212223.png](https://forensics.xidian.edu.cn/wiki/attachments/Pasted%20image%2020251111212223.png)

### 23 接上题，嫌疑人当前看到该小说的第几章[¶](https://forensics.xidian.edu.cn/wiki/Longxin2025/#23_1 "Permanent link")

答案

第五十一章

见上题.